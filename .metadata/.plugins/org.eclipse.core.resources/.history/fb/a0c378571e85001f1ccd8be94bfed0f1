package co.edu.uco.PrubaPatrones.EjecucionMainFactoryDAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import co.edu.uco.PrubaPatrones.EjecucionMainFactoryDAO.ModeloFD.Persona;
import co.edu.uco.PrubaPatrones.EjecucionMainFactoryDAO.ModeloFD.Profesor;

public class ProfesorDAO implements PersonaDAO {
	
	private static final String INSERT_PROFESOR_SQL = "INSERT INTO profesor (nombre, edad, asignatura) VALUES (?, ?, ?)";
    private static final String SELECT_PROFESOR_BY_ID = "SELECT * FROM profesor WHERE id = ?";

	@Override
	public void guardar(Persona persona) {
		Profesor profesor = (Profesor) persona; // Casting, porque sabemos que es un Profesor
        try (Connection connection = ConexionDB.getConnection();
             PreparedStatement preparedStatement = connection.prepareStatement(INSERT_PROFESOR_SQL)) {
            
            preparedStatement.setString(1, profesor.getNombre());
            preparedStatement.setInt(2, profesor.getEdad());
            preparedStatement.setString(3, profesor.getAsignatura());

            preparedStatement.executeUpdate();
            System.out.println("Profesor guardado exitosamente.");
        } catch (SQLException e) {
            e.printStackTrace();
        }
		
	}

	@Override
	public Persona obtenerPorId(int id) {
		Profesor profesor = null;
        try (Connection connection = ConexionDB.getConnection();
             PreparedStatement preparedStatement = connection.prepareStatement(SELECT_PROFESOR_BY_ID)) {
            
            preparedStatement.setInt(1, id);
            ResultSet rs = preparedStatement.executeQuery();

            if (rs.next()) {
                String nombre = rs.getString("nombre");
                int edad = rs.getInt("edad");
                String asignatura = rs.getString("asignatura");
                profesor = new Profesor(nombre, edad, asignatura);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return profesor;
	}

}
